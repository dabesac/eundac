
<spam class="alert " style="display: block; font-size: 16px; margin: 3px; padding: 5px; text-align: center">
<b>ASIGNATURAS A CARGO PERIODO - <?php  echo $this->perid?></b>
<?php $partial=$this->partial;?>
</spam>
<?php 
  $c=0;
  foreach ($this->faculty as $number) {
    $c++;
    $c;
    $fname=$number['name'];
?>
<div class="panel-group" id="accordion">
    <div class="panel panel-primary">
        <div class="panel-heading ">
            <h4 class="panel-title ">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse<?php echo $c?>"
                style="font-size: 18px;">
                    <b>FACULTAD <?php echo strtoupper($fname)?></b>                         
                </a>
            </h4>
        </div>
        <div id="collapse<?php echo $c?>" class="panel-collapse collapse in">
            <div class="panel-body" >
                <div class='row'>
                    <div class='col-md-11 col-md-offset-1'>
                        <div class='row'>

                            <?php 
                                $f=0;
                                foreach ($this->data as $courses) {
                                $f++;

                                $u_="";
                                $urlAsist ="/".base64_encode('escid')."/".base64_encode($courses['escid'])."/".base64_encode('subid')."/".base64_encode($courses['subid'])."/".base64_encode('courseid')."/".base64_encode($courses['courseid'])."/".base64_encode('turno')."/".base64_encode($courses['turno'])."/".base64_encode('perid')."/".base64_encode($courses['perid'])."/".base64_encode('curid')."/".base64_encode($courses['curid'])."/".base64_encode('state')."/".base64_encode($courses['state_record']);
                                $u_ = $courses['curid'].$courses['courseid'].$courses['turno'];
                                $urlcampus = "http://campus.undac.edu.pe/courses/$u_/index.php";
                                

                                $where['eid']=$courses['eid'];
                                $where['oid']=$courses['oid'];
                                $where['curid']=$courses['curid'];
                                $where['escid']=$courses['escid'];
                                $where['subid']=$courses['subid'];
                                $where['courseid']=$courses['courseid'];                             

                              
                                $list= new Api_Model_DbTable_Course();
                                $course=$list->_getOne($where);                     
                                if ($number['facid']==$courses['facid']) { ?>
                                    <div class='col-md-3 cont-coruse' >


                                        <div class="notes-option">

                                            <?php switch ($courses['type_rate']) {
                                            case 'O': ?>
                                                <a class="list-option-notes" data-toggle="tooltip" title="Notas 1er Parcial" href="/docente/fillnotes/target<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode($partial) ?>" ><span class='glyphicon glyphicon-list'></span></a>
                                            <?php       break;
                                                case 'C': ?>
                                                    <a class="list-option-notes" href="/docente/fillnotes/competition<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode($partial)?>" data-toggle="tooltip" title="Registrar las Notas"><span class='glyphicon glyphicon-list'></span></a>

                                                    <buttom <?php echo ($courses['state']=='P' || $courses['state']=='C' )? 'disabled':''?> class="list-option-notes load-persentage" href="/docente/fillnotes/persentagecompetition<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode($partial)?>" data-toggle="tooltip" title="Asignar Porsentage" ><span class='glyphicon glyphicon-stats'></span></buttom>                               
                                            <?php        break;
                                                default: ?>
                                                    <div class="alert alert-danger">Tipo de Curso no Asignado</div>
                                             <?php       break;
                                            }?>

                                            <a class="list-option-notes" href="/assistance/student/index<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode($partial)?>" data-toggle="tooltip" title="Llenado de Asistencia" ><span class='glyphicon glyphicon-calendar'></span></a>

                                             <a class="list-option-notes" href="/syllabus/syllabus/index/escid/<?php echo base64_encode($courses['escid'])?>/curid/<?php echo base64_encode($courses['curid'])?>/courseid/<?php echo base64_encode($courses['courseid'])?>/turno/<?php echo base64_encode($courses['turno'])?>/subid/<?php echo base64_encode($courses['subid'])?>/perid/<?php echo base64_encode($courses['perid'])?>" data-toggle="tooltip" title="Registro del SÃ­labo" ><span class='glyphicon glyphicon-list-alt'></span></a>
                                            

                                            <?php if ($courses['closure_record_n']=='P' || $courses['closure_record_n']=='C') { ?>
                                              <?php switch ($courses['type_rate']) {
                                                case 'O': ?>
                                                    <a class="list-option-notes" data-toggle="tooltip" title="Notas 2do Parcial" href="/docente/fillnotes/target<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode('2') ?>" ><span class='glyphicon glyphicon-th-list'></span></a>
                                                <?php       break;
                                                    case 'C': ?>
                                                        <a class="list-option-notes" href="/docente/fillnotes/competition<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode('2')?>" data-toggle="tooltip" title="Notas 2do Parcial"><span class='glyphicon glyphicon-th-list'></span></a>

                                                        <buttom <?php echo ($courses['state']=='P' || $courses['state']=='C' )? 'disabled':''?> class="list-option-notes load-persentage" href="/docente/fillnotes/persentagecompetition<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode('2')?>" data-toggle="tooltip" title="Asignar Porsentage 2do Parcial" ><span class='glyphicon glyphicon-stats'></span></buttom>                               
                                                <?php        break;
                                                    default: ?>
                                                        <div class="alert alert-danger">Tipo de Curso no Asignado</div>
                                                 <?php       break;
                                                }?>

                                                <a class="list-option-notes" href="/assistance/student/index<?php echo $urlAsist."/".base64_encode('partial')."/".base64_encode('2')?>" data-toggle="tooltip" title="Asistencia 2do Parcial" ><span class='glyphicon glyphicon-calendar'></span></a>
                                            <?php }?>

                                        </div>






                                        <?php if (
                                                    (round($courses['persetage_assit']) == 50 || round($courses['persetage_assit']) == 100 ) &&
                                                    (round($courses['persetage_notes']) == 50 || round($courses['persetage_notes']) == 100 ) &&
                                                    ($courses['closure_syllabus'] == 'C')&& ($courses['closure_record_n']=='P' || $courses['closure_record_n']=='C')

                                                ) {?>
                                                <img src="/img/closure_.png" class='img-closure-course'>
                                        <?php }else{?>
                                            <h1 class='span-course'><span class='glyphicon glyphicon-book'></span></h1>
                                        <?php }?>

                                        

                                        <h4 class='name-course'><?php echo $course['curid']." - ".$course['courseid']." - ".$course['name']." - Turno ".$courses['turno']?></h4>

                                       


                                        <h5 class='text-persentage-couser'>Llenado de Notas. 
                                            <?php echo round($courses['persetage_notes'])?>%
                                            <?php if ($courses['persetage_notes']== 50 || $courses['persetage_notes']== 100) {?>
                                                <span class='glyphicon glyphicon-ok-sign text-success'></span>
                                            <?php }else{ ?>
                                                <span class='glyphicon glyphicon-info-sign text-danger'></span>
                                            <?php }?>
                                        </h5>
                                        <div class="progress-course progress progress-striped active">
                                          <div class="progress-bar"  role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: <?php echo $courses['persetage_notes']?>%">
                                          </div>
                                        </div>

                                        <h5 class='text-persentage-couser'>Llenado de Asistencia. <?php echo round($courses['persetage_assit'])?>%
                                            <?php if ($courses['persetage_assit']== 50 || $courses['persetage_assit']== 100) {?>
                                                <span class='glyphicon glyphicon-ok-sign text-success'></span>
                                            <?php }else{ ?>
                                                <span class='glyphicon glyphicon-info-sign text-danger'></span>
                                            <?php }?>
                                        </h5>
                                        <div class="progress-course progress progress-striped active">
                                          <div class="progress-bar progress-bar-danger"  role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: <?php echo $courses['persetage_assit']?>%">
                                          </div>
                                        </div>
                                        <h5 class='text-persentage-couser'>Llenado de SÃ­labo. 
                                            <?php if ($courses['closure_syllabus']=='C') {?>
                                                <span class='glyphicon glyphicon-ok-sign text-success'></span>
                                            <?php }else{?>
                                                <span class='glyphicon glyphicon-info-sign text-danger'></span>
                                            <?php }?></h5>

                                        <br>
                                        <h5 class='text-persentage-couser' >Duplicar el silabo desde: 
                                        </h5>
                                        <?php

                                        $u=$this->uid;

                                        $where_uid = array('eid'=>$where['eid'],'oid'=>$where['oid'],'perid'=>$this->perid,'uid' => $u,
                                                'is_main'=>'S', );

                                                //print_r($where_uid);

                                        $cour=new Api_Model_DbTable_Coursexteacher();
                                        $cc=$cour->_getFilter($where_uid);                                                                           
                                        //Aqui las escuelas de origen
                                        $cour=$course['courseid'];
                                        $esc=$course['escid'];
                                        $tur=$courses['turno'];
                                        $cur=$course['curid'];

                                        ?>
                                        <div>
                                
                                        <select id="courses_<?php echo $f?>" name="courses_<?php echo $f?>" class="form-control"> 
                                                <option value="">Seleccione el curso </option>
                                        <?php
                                                
                                                foreach ($cc as $courses)

                                                {

                                                if(($courses['courseid']==$cour and $courses['escid']<>$esc) OR ($courses['courseid']==$cour and $courses['turno']<>$tur))
                                                {

                                                $crorigen=$courses['courseid']; 
                                                $escorigen=$courses['escid']; 
                                                $cuorigen=$courses['curid']; 
                                                $suorigen=$courses['subid']; 
                                                $tuorigen=$courses['turno']; 
                                                //$crname=$courses['name'];                                
                                                //print_r($courses);  
                                                                                
                                                $where_course = array('eid'=>$where['eid'],'oid'=>$where['oid'],'courseid'=>$crorigen,'escid'=>$escorigen,'curid'=>$cuorigen,'subid'=>$suorigen);

                                                //print_r($where_course);                                            

                                                $name= new Api_Model_DbTable_Course();
                                                $name_co=$name->_getOne($where_course);
                                                //print_rx($name_co);
                                                $nom=$name_co['name'];

                                                $where_spe = array('eid'=>$where['eid'],'oid'=>$where['oid'],'escid'=>$escorigen,'subid'=>$suorigen);

                                                $name_spe= new Api_Model_DbTable_Speciality();
                                                $nspe=$name_spe->_getOne($where_spe);
                                                $nom_spe=$nspe['name'];


                                                ?>                                          
                                                <option value="<?php echo $crorigen.";--;".$tuorigen.";--;".$escorigen.";--;".$this->perid.";--;".$cur.";--;".$esc.";--;".$cour.";--;".$tur?>"><?php echo $crorigen."-".$nom."-".$tuorigen."-".$nom_spe;?></option> 
                                                <?php
                                                }
                                                
                                                }

                                                ?>
                                        </select>
                                        </div>
                                      

                                        <script>
                                            //$(function() {
                                            //var year_a="<?php echo base64_encode(date('Y'));?>";
                                            $("#courses_<?php echo $f ?>").change(function(){

                                            if(confirm("Esta seguro de duplicar \nel silabo"))
                                            var courses =$("#courses_<?php echo $f ?>").val();
                                            //alert("<?php echo $f ?>")
                                            //alert(courses)

                                            tmp=courses.split(";--;");
                                            courorigen=tmp[0];
                                            tuorigen=tmp[1];
                                            esorigen=tmp[2];
                                            perid=tmp[3];
                                            cur=tmp[4];
                                            escid=tmp[5];
                                            courseid=tmp[6];
                                            turno=tmp[7];
                                                                       
                                            url="/docente/notas/courses/perid/"+perid+"/courseidorigen/"+courorigen+"/turnoorigen/"+tuorigen+"/escidorigen/"+esorigen+"/curid/"+cur+"/escid/"+escid+"/courseid/"+courseid+"/turno/"+turno;
                                            //alert(courorigen)
                                            //alert(courseid)
                                            //alert(url)
                                            $("#sil").html("<option value=''>Cargando...</option>");
                                            $("#sil").load(url);       
                                            });
                                            //$("#perid").load("/record/index/periods/year/"+year_a);    
                                            //});
                                        </script>


                                    </div>

                                <?php }
                            }?>
                        </div>
                    </div>
                </div>
            </div>
        </div>
  </div>
</div>
<?php 
}

?>


<div id='sil'></div>




<div class="modal fade" id="modal-persentage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

</div><!-- /.modal -->




<script>

$(".load-persentage").click(function(){
    var $url = $(this).attr('href');
    $("#modal-persentage").modal('show');
    $.get($url,function($data){
        $("#modal-persentage").html($data);
    });
    
    return false;
});



$(function () {
    $(".list-option-notes").tooltip({ placement: 'right' });
});
</script>
<style>
.curso{
    float: left;
    width: 380px;
    margin-right: 20px;
    padding: 5px;
    
    border-radius: 5px;
    border: 1px solid #000000;  
    margin-bottom: 20px;
    border: 1px solid rgb(212, 212, 212);
    box-shadow: 0px 0px 7px #343434;
  opacity: 0.6;
  
}

.curso:hover{
  opacity: 1.0;
    z-index:999;
      -webkit-transform: scale(1);  
      -moz-transform: scale(1);  
      -ms-transform: scale(1);   
      -o-transform: scale(1);   
    transform: scale(1);  
}
.curso div {
    float: left;
}
.curso > div {
    width: 360px; 
}
</style>