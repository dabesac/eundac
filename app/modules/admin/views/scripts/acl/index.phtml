<div><h2>ACL</h2></div>
<div class="row">
	<div class="col-md-11 pull-right"><h4>Rol</h4>
	<select name="rol" id="rol" class="input-sm">
			<option value="">Selecione..</option>
			<?php if($this->rols){
				$c=0;
				foreach ($this->rols as $rls) {?>
					<option value="<?php echo $rls['rid']?>"><?php echo $rls['name']?></option>		
				<?php $c++;
				}
			}?>
		</select>
	<div class="col-md-7 pull-right"><a class="btn btn-info" id="new">Nuevo</a></div>
	</div>
</div>

<div id="list_acl" name="list_acl"></div>

<form name="<?php echo $this->form->getName(); ?>" id="<?php echo $this->form->getName(); ?>" action="<?php echo $this->form->getAction(); ?>" 
	method="post" enctype="application/x-www-form-urlencoded">
<div class="modal fade" id="enternewdata">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        		<h3 class="modal-title">Nuevo ACL</h3>
      		</div>
      		<div class="modal-body">
	      		<table class="table">
	        		<tr>
	        			<input type="hidden" name="rid" id="rid">
	        			<td>Modulo</td>
	        			<td><?php print $this->form->mid?></td>
	        		</tr>
	        		<tr>
	        			<td>Nombre</td>
	        			<td><?php print $this->form->reid?></td>
	        		</tr>
	        		<tr>
	        			<td>Estado</td>
	        			<td><?php print $this->form->state?></td>
	        		</tr>
	        	</table>
      		</div>
      		<div class="modal-footer">
      			<button type="button" class="btn btn-danger pull-right" data-dismiss="modal">Cerrar</button>
        		<?php print $this->form->save?>
      		</div>
		</div>
  	</div>
</div>
</form>
<script>
	$("#rol").change(function(){
		var rid = $("#rol").val();
		var url = "/admin/acl/listacl/rid/"+rid;
		$("#list_acl").html("<img src='/img/spinner.gif'>Cargando...");
		$("#list_acl").load(url);
	});
	
	$("#new").click(function(){
		var rid=($("#rol").val());
		$("#rid").val(rid);
		if(rid){
			$("#enternewdata").modal("show")
		}else{
			alert("Elija un Rol!")
		}
	});

	$("#mid").change(function(){
	var mid = ""+$("#mid").val();
	var url = "/admin/acl/listr/mid/"+mid;
	$("#reid").load(url);

	$("#new").click(function(){
		alert("work");
		e.preventDefault();
		$("#list_acl").html("<img src='/img/spinner.gif'>Cargando....");
		$.ajax({
	        type: "POST",
	        url: $("#frmAcl").attr("action"),
	        data: $("#frmAcl").serialize(),
	        success: function(data){
	       		$("#list_acl").html(data);
	      	}		
		});
		return false;
	});
});
</script>