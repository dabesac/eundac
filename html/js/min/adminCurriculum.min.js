$(function(){function e(){function e(e){$("#dataCurriculums").html(""),e?$("#selectSchool").html('<option value="">Cargando...</option>').load("/default/global/listschools/id/"+e):$("#selectSchool").html('<option value="">Escuela</option><option value="">Primero seleccione alguna facultad ¬¬</option>')}function i(e){e?$("#dataCurriculums").html('<br><br><center><img src="/img/spinner.gif" alt="Loading" /></center>').load("/curricula/curricula/listcurriculums/id/"+e,function(){k=$("#selectSpeciality").val(),a(k),s()}):$("#dataCurriculums").html("")}function a(e){$(".curriculums").each(function(){currentLiText=$(this).text(),showCurrentLi=-1!==currentLiText.indexOf(e),$(this).toggle(showCurrentLi),showCurrentLi&&(existData=0)}),"RC"==r&&$("html body").animate({scrollTop:$("#selectFaculty").offset().top})}function s(){$("#selectSpeciality").on("change",function(){k=$(this).val(),a(k),"RC"==r&&$("#dataFormNewCur").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/newcurricula/id/"+k,function(){l()})}),"RC"==r&&$("#dataFormNewCur").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/newcurricula/id/"+k,function(){l()});var e;$(".curriculum").each(function(i,a){e=$(a).attr("idactivatejs"),t(e)})}function t(e){var i=$("#curriculum"+e),a=$(i).find(".modify").children(".btnDetailCur"),r=$(i).find(".modify").children(".btn_derive"),s=$(i).find(".modify").children(".btn_delete"),t=$(i).attr("state");$(i).hasClass("showCurriculum")&&$(i).removeClass("showCurriculum"),$(a).on("click",function(){c(),S=$(this).attr("ide"),N=$(this).attr("idjs"),$("#dataDetailCur").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/admincurriculum/state/"+t+"/id/"+S,function(){d(S,N)})});var l,u;$(r).on("click",function(){u=$(this);var e=$(u).siblings(".derive_from_draft");l=$(u).attr("goto"),S=$(u).attr("ide"),N=$(u).attr("idjs"),$(u).toggleClass("active_a");var i="";$(".derive_from_draft").each(function(e,a){i=$(a).attr("fromto"),l!=i&&$(a).hasClass("active_derive")&&($(a).siblings(".btn_derive").removeClass("active_a"),$(a).addClass("hide_derive"),setTimeout(function(){$(a).removeClass("active_derive hide_derive")},300))}),$(".delete_curriculum").each(function(e,i){$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),$(".btn_delete").removeClass("active_delete"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm"),$(i).parent().slideUp(150)},300))}),$(e).hasClass("active_derive")?($(e).addClass("hide_derive"),setTimeout(function(){$(e).removeClass("active_derive hide_derive")},300)):$(e).addClass("active_derive")}),$(s).on("click",function(){u=$(this),l=$(u).attr("goto"),S=$(u).attr("ide"),$(".btn_derive").removeClass("active_a active_active active_temporary active_close"),$(".derive_from_draft").each(function(e,i){$(i).hasClass("active_derive")&&($(i).addClass("hide_derive"),setTimeout(function(){$(i).removeClass("active_derive hide_derive")},300))})}),$("#curriculum"+e+" .derive_from_draft a, #curriculum"+e+" .btn_delete").on("click",function(){var e=$(this),i=$(e).parent(".derive_from_draft");$(i).addClass("hide_derive"),setTimeout(function(){$(i).removeClass("active_derive hide_derive")},300);var a=$(e).attr("type"),r="",s="";$(".confirm_side").each(function(e,i){s=$(i).parent().attr("fromto"),r=$(i).attr("type"),l!=s?$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm"),$(i).parent().slideUp(150)},300)):a!=r&&$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm")},300))}),$(".btn_delete").removeClass("active_delete"),$(".btn_derive").removeClass("active_a active_active active_temporary active_close");var t=a+"_curriculum",c="active_"+a,n=$("#curriculum_confirm"+l).find("."+t);$("#curriculum_confirm"+l).slideDown(150),$(n).addClass("active_confirm"),$(u).removeClass("active_a active_active active_temporary active_close").addClass(c)}),$("#curriculum_confirm"+e+" .confirm_side a:nth-child(3)").on("click",function(){c()}),$("#curriculum_confirm"+e+" .confirm_side a:nth-child(2)").on("click",function(){var e=$(this).attr("whycallme");$(this).html('<img src="/img/spinner.gif" alt="Loading..." />'),n(e,S,l)})}function c(){$(".btn_derive").removeClass("active_a active_active active_temporary active_close"),$(".btn_delete").removeClass("active_delete"),$(".confirms_side .confirm_side").each(function(e,i){$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm"),$(i).parent().slideUp(150)},300))}),$(".derive_from_draft").each(function(e,i){$(i).hasClass("active_derive")&&($(i).siblings(".btn_derive").removeClass("active_a"),$(i).addClass("hide_derive"),setTimeout(function(){$(i).removeClass("active_derive hide_derive")},300))})}function n(e,i,a){$.ajax({url:"/curricula/curricula/icallyou",data:{id:i,why:e},dataType:"json",success:function(r){if(1===r.success){c();var s=new Object;if(s.name=$("#curriculum"+a+" span:nth-child(2)").html(),s.year=$("#curriculum"+a+" span:nth-child(3)").html(),"A"==e){var n=$("#curriculums"+k).find(".div_active"),l=$("#curriculum"+a).parent(),d=$(n).children(".curriculum");if($(d).attr("state")){var u=new Object;u.name=$(d).children("span:nth-child(2)").html(),u.year=$(d).children("span:nth-child(3)").html(),u.idJs=$(d).attr("idactivatejs"),u.idGet=$(d).attr("idget")}$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove();var e='<div id="curriculum'+a+'" class="curriculum showCurriculum" idactivatejs="'+a+'" idget="'+i+'" state="A"><span><span class="glyphicon glyphicon-ok"></span></span><span>'+s.name+"</span><span>"+s.year+'</span><div class="modify active_modify"><a href="##" ide="'+i+'" idjs="'+a+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a></div></div>';if($(n).html(e),t(a),$(n).siblings(".empty").slideUp("fast"),$(d).attr("state")){e='<div id="curriculum'+u.idJs+'" class="curriculum showCurriculum" idactivatejs="'+u.idJs+'" state="T"><span><span class="glyphicon glyphicon-ok"></span></span><span>'+u.name+"</span><span>"+u.year+'</span><div class="modify temporary_modify"><a href="##" ide="'+u.idGet+'" idjs="'+u.idJs+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="##" class="btn_derive" ide="'+u.idGet+'" goto="'+u.idJs+'">Derivar</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a><div class="derive_from_draft" fromto="'+u.idJs+'"><a href="##" type="active">Activar Curricula</a><a href="##" type="close">Cerrar Curricula</a></div></div></div><div id="curriculum_confirm'+u.idJs+'" fromto="'+u.idJs+'" class="confirms_side"><div class="confirm_side delete_curriculum" type="delete"><p>Confírme si desea eliminar esta currícula...</p><a href="##" whycallme="D">Si, quiero eliminarla</a><a href="##">Cancelar</a></div><div class="confirm_side active_curriculum" type="active"><p>Confírme si desea activar esta currícula, si hay otra activa ésta la remplazara...</p><a href="##" whycallme="A">Si, quiero activarla</a><a href="##">Cancelar</a></div><div class="confirm_side temporary_curriculum" type="temporary"><p>Confírme si desea mover esta currícula a temporales...</p><a href="##" whycallme="T">Si, quiero moverla a temporales</a><a href="##">Cancelar</a></div><div class="confirm_side close_curriculum" type="close"><p>Confírme si desea cerrar esta currícula...</p><a href="##" whycallme="C">Si, quiero cerrarla</a><a href="##">Cancelar</a></div></div>';var r=$("#curriculums"+k).find(".div_temporary");$(r).prepend(e),t(u.idJs),T(r)}T(l)},300)}else if("T"==e){var n=$("#curriculums"+k).find(".div_temporary"),l=$("#curriculum"+a).parent();$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove();var e='<div id="curriculum'+a+'" class="curriculum showCurriculum" idactivatejs="'+a+'" state="T"><span><span class="glyphicon glyphicon-ok"></span></span><span>'+s.name+"</span><span>"+s.year+'</span><div class="modify temporary_modify"><a href="##" ide="'+i+'" idjs="'+a+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="##" class="btn_derive" ide="'+i+'" goto="'+a+'">Derivar</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a><div class="derive_from_draft" fromto="'+a+'"><a href="##" type="active">Activar Curricula</a><a href="##" type="close">Cerrar Curricula</a></div></div></div><div id="curriculum_confirm'+a+'" fromto="'+a+'" class="confirms_side"><div class="confirm_side delete_curriculum" type="delete"><p>Confírme si desea eliminar esta currícula...</p><a href="##" whycallme="D">Si, quiero eliminarla</a><a href="##">Cancelar</a></div><div class="confirm_side active_curriculum" type="active"><p>Confírme si desea activar esta currícula, si hay otra activa ésta la remplazara...</p><a href="##" whycallme="A">Si, quiero activarla</a><a href="##">Cancelar</a></div><div class="confirm_side temporary_curriculum" type="temporary"><p>Confírme si desea mover esta currícula a temporales...</p><a href="##" whycallme="T">Si, quiero moverla a temporales</a><a href="##">Cancelar</a></div><div class="confirm_side close_curriculum" type="close"><p>Confírme si desea cerrar esta currícula...</p><a href="##" whycallme="C">Si, quiero cerrarla</a><a href="##">Cancelar</a></div></div>';$(n).prepend(e),t(a),T(l),T(n)},300)}else if("C"==e){var n=$("#curriculums"+k).find(".div_close"),l=$("#curriculum"+a).parent();$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove();var e='<div id="curriculum'+a+'" class="curriculum" idactivatejs="'+a+'" state="C"><span>0</span><span>'+s.name+"</span><span>"+s.year+'</span><div class="modify close_modify"><a href="##" ide="'+i+'" idjs="'+a+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a></div></div>';$(n).prepend(e),t(a),T(l),T(n)},300)}else if("D"==e){var l=$("#curriculum"+a).parent();$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove(),T(l)},300)}}},error:function(){}})}function l(){$("#formCurriculum").on("submit",function(e){e.preventDefault();var i=$(this),a=$(this).find("input[type=submit]"),r=$(this).siblings(".msg_side").children(".msg.warning"),s=$(this).siblings(".msg_side").children(".msg.success");a.attr("disabled","disabled").val("Guardando..."),$.ajax({type:"post",url:"/curricula/curricula/savenew",data:$(this).serialize(),dataType:"json",success:function(e){if(1===e.success){var c='<div class="curriculum" id="curriculum'+e.dataNew.idJs+'" state="B"><span>RC</span><span><span class="nameChangeEdit">'+e.dataNew.name+"</span> <small>"+e.dataNew.curid+"</small></span><span>Año "+e.dataNew.year+'</span><div class="modify draftModify"><a href="##" ide="'+e.dataNew.id+'" idjs="'+e.dataNew.idJs+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Administrar Curricula</a><a href="##" class="btn_derive" ide="'+e.dataNew.id+'" goto="'+e.dataNew.idJs+'">Derivar</a><a href="##" class="btn_delete" ide="'+e.dataNew.id+'" type="delete" goto="'+e.dataNew.idJs+'">Eliminar</a><div class="derive_from_draft" fromto="'+e.dataNew.idJs+'"><a href="##" type="active">Activar Curricula</a><a href="##" type="temporary">Mover a Temporales</a><a href="##" type="close">Cerrar Curricula</a></div></div></div><div id="curriculum_confirm'+e.dataNew.idJs+'" fromto="'+e.dataNew.idJs+'" class="confirms_side"><div class="confirm_side delete_curriculum" type="delete"><p>Confírme si desea eliminar esta currícula...</p><a href="##" whycallme="D">Si, quiero eliminarla</a><a href="##">Cancelar</a></div><div class="confirm_side active_curriculum" type="active"><p>Confírme si desea activar esta currícula, si hay otra activa ésta la remplazara...</p><a href="##" whycallme="A">Si, quiero activarla</a><a href="##">Cancelar</a></div><div class="confirm_side temporary_curriculum" type="temporary"><p>Confírme si desea mover esta currícula a temporales...</p><a href="##" whycallme="T">Si, quiero moverla a temporales</a><a href="##">Cancelar</a></div><div class="confirm_side close_curriculum" type="close"><p>Confírme si desea cerrar esta currícula...</p><a href="##" whycallme="C">Si, quiero cerrarla</a><a href="##">Cancelar</a></div></div>',n=$("#curriculums"+k).find(".div_draft");$(n).prepend(c),t(e.dataNew.idJs),T(n),$(i).find(".form-control").val(""),D(s,r,2e3),clearTimeout(q),q=setTimeout(function(){$("#modalNewCur").modal("hide"),a.removeAttr("disabled").val("Guardar")},2e3),$("#curriculums"+k).find(".main_draft").slideDown("fast")}else 0===e.success&&(j(r,e.errors),D(r,s,7e3))},error:function(){D(r,s,7e3),$(r).html("<p>Ups! Parece que hubo un error, fijese que no haya otra currícula en el mismo año y periódo igual al que esta creando...</p>")}}),a.removeAttr("disabled").val("Guardar")})}function d(e){$("#detailCur_btnEditCur").on("click",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeOut("fast",function(){$("#idDivEditCurriculum, #idHeaderEdit").fadeIn("fast")})}),$("#detailCur_btnAdminCourses").on("click",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeOut("fast",function(){$("#idDivAdminCourses, #idHeaderAdmin").fadeIn("fast")})}),$("#detailCur_edit_btnBackToDetail").on("click",function(){$("#idDivEditCurriculum, #idHeaderEdit").fadeOut("fast",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeIn("fast")})}),$("#detailCur_courses_btnBackToDetail").on("click",function(){$("#idDivAdminCourses, #idHeaderAdmin").fadeOut("fast",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeIn("fast")})}),$("#idDivDetailCurricula").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/detailcurriculum/id/"+e,function(){u()}),("RC"==r||"DR"==r)&&$("#idDivEditCurriculum").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/editcurriculum/id/"+e,function(){o(e,N)}),$("#idDivAdminCourses").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/admincourses/id/"+e,function(){m(e,N)})}function u(){}function o(e){$("#formEditCurriculum").on("submit",function(i){i.preventDefault();var a=$(this).find("input[type=submit]"),r=($(this).find("input[name=name]").val(),$(this).siblings(".msg_side").children(".msg.warning")),s=$(this).siblings(".msg_side").children(".msg.success");$(a).attr("disabled","disabled").val("Guardando..."),$.ajax({type:"post",url:"/curricula/curricula/saveedit",data:$(this).serialize(),dataType:"json",success:function(i){1===i.success?(D(s,r,2e3),$("#idDivDetailCurricula").html('<img src="/img/spinner.gif" alt="Loading..." />').load("/curricula/curricula/detailcurriculum/id/"+e,function(){u()}),$("section.new_course").load("/curricula/curricula/newcourse/id/"+e,function(){v()})):0===i.success?(j(r,i.errors),D(r,s,7e3)):2===i.success,a.removeAttr("disabled").val("Guardar")},error:function(){a.removeAttr("disabled").val("Guardar")}})})}function m(){$("section.new_course").load("/curricula/curricula/newcourse/id/"+S,function(){v()}),$("#btn_add_course").on("click",function(){$("#id_error_course_side").slideUp("fast"),$("#id_add_new_course").hasClass("active")?($(this).removeClass("btn_cancel").html("Agregar Curso"),$(this).parent().parent().removeClass("header_active"),$("#id_add_new_course").addClass("inactive"),setTimeout(function(){$("#id_add_new_course").removeClass("active inactive")},300)):($(this).addClass("btn_cancel").html("Cancelar"),$(this).parent().parent().addClass("header_active"),$("#id_add_new_course").addClass("active"))});var e;$(".all_course_data").each(function(i,a){e=$(a).attr("idactivatejs"),C(e)})}function v(){$("#form_add_new_course").on("submit",function(e){e.preventDefault();var i=$(this),a=$(this).parent().parent().siblings("header").find("a#btn_add_course"),r=($(this).find("input[type=submit]"),$(this).siblings(".msg_side").children(".msg.warning")),s=$(this).siblings(".msg_side").children(".msg.success");$.ajax({type:"post",url:"/curricula/curricula/savecourse",data:$(this).serialize(),dataType:"json",success:function(e){if(1===e.success){var t='<div id="id_course_'+e.idjs+'" class="all_course_data" idactivatejs="'+e.idjs+'"><article class="data_course"><span>#</span>	<span>'+e.idjs+"</span><span>"+e.name+"</span><span>"+e.credits+"</span><span>"+e.type+"</span><span>"+e.req+'</span><span class="stateA">A</span><a href="##" class="btn_edit_course" code="'+e.idget+'">Editar</a></article><article class="edit_course"></article></div>';$("#id_section_semester"+e.semester).append(t),C(e.idjs),w($("#id_section_semester"+e.semester)),D(s,r,1700),setTimeout(function(){$(i).find("input[type=text]").val(""),$(i).find("select[name=semid]").val(1),$("#id_select_pre").append('<option semester="'+e.semester+'" code-course="'+e.idjs+'" value="'+e.id_en+'">'+e.idjs+" | "+e.name+"</option>");var r=$("#id_select_pre").parent().siblings(".prerequisites");p($("#id_select_pre"),1),$(r).children("article").each(function(){var e=$(this);1<$(e).attr("semester")&&($(e).addClass("inactive"),setTimeout(function(){var i=!1;$(e).removeClass("active inactive").remove(),$(r).children("article").each(function(e){var a=e+1;$(this).find("input").attr("name","pre_"+a),i=!0}),i||$(r).children("p").removeClass("inactive")},300))}),$(a).removeClass("btn_cancel").html("Agregar Curso"),$(a).parent().parent().removeClass("header_active"),$("#id_add_new_course").addClass("inactive"),setTimeout(function(){$("#id_add_new_course").removeClass("active inactive")},300)},2e3)}else 0===e.success&&(j(r,e.errors),D(r,s,7e3))},error:function(){}})});{var e=$("#id_select_pre").parent().siblings(".prerequisites");$(e).children("p")}h($("#semid"),$("#id_select_pre"),e);var i=$("#id_select_eq").parent().siblings(".equivalence_side");g($("#id_select_eq"),i);var a=$("#js_p_tab_pre_eq");f(a)}function f(e){$(e).children(".js_pre_eq").on("click",function(){if(!$(this).hasClass("active")){$(this).addClass("active"),$(this).siblings("a").removeClass("active");var e=$(this).parent().siblings(".p-js_section_"+$(this).attr("go-to"));e.hasClass("active")||(e.siblings(".p-js_section").addClass("inactive"),setTimeout(function(){e.siblings(".p-js_section").removeClass("active inactive"),e.addClass("active")},300))}})}function h(e,i,a){var r=$(e).val();p(i,r),$(e).on("change",function(){r=parseInt($(this).val()),p(i,r),$(a).children("article").each(function(){var e=$(this);r<$(e).attr("semester")&&($(e).addClass("inactive"),setTimeout(function(){var i=!1;$(e).removeClass("active inactive").remove(),$(a).children("article").each(function(e){var a=e+1;$(this).find("input").attr("name","pre_"+a),i=!0}),i||$(a).children("p").removeClass("inactive")},300))})});var s=$(a).children("p"),t=0;$(i).siblings("a").on("click",function(){var e=$(i).val(),c=!1;if($(a).children("article").each(function(){e==$(this).find("input").val()&&(c=!0)}),e&&!c){var n=$(i).children("option:selected").html(),l=1;if($(a).children("article").each(function(){l++,t++}),3>=l){var d='<article semester="'+r+'" id="prerequisite'+t+'"><p>'+n+'</p><input type="hidden" name="pre_'+l+'" value="'+e+'"><a href="##"><span class="glyphicon glyphicon-remove"></span></a></article>';$(s).addClass("inactive"),$(a).append(d),_(t,a),t++}}})}function p(e,i){var a,r=!1,s=!1;$(e).children("option").each(function(){a=parseInt($(this).attr("semester")),i>a?(r||a!=i-1||($(e).children("option[semester=0]").html("Agregue un prerequisito..."),$(e).val($(this).val()),r=!0),0!=a&&(s=!0),$(this).removeAttr("hidden")):$(this).attr("hidden","true")}),s&&!r?$(e).children("option[semester=0]").html("Agregue un prerequisito..."):s||($(e).children("option[semester=0]").html("No hay prerequisitos..."),$(e).val("")),1==i&&$(e).children("option[semester=0]").html("No hay prerequisitos para el primer semestre...")}function _(e,i){var a=$(i).find("#prerequisite"+e);$(a).addClass("active"),$(a).find("a").on("click",function(){$(a).addClass("inactive"),setTimeout(function(){var e=!1;$(a).removeClass("active inactive").remove(),$(i).children("article").each(function(i){var a=i+1;$(this).find("input").attr("name","pre_"+a),e=!0}),e||$(i).children("p").removeClass("inactive")},300)})}function C(e){var i=$("#id_course_"+e).find(".btn_edit_course"),a=$("#id_course_"+e).find("article.data_course"),r=$("#id_course_"+e).find("article.edit_course");$(i).on("click",function(){var e=$(this).attr("code");if($(a).hasClass("course_clicked"))$(a).removeClass("course_clicked"),$(i).html("Editar"),$(r).addClass("inactive"),setTimeout(function(){$(r).removeClass("active inactive")},300);else{$(r).html('<img src="/img/spinner.gif" alt="Loading..." />').load("/curricula/curricula/editcourse/id/"+e,function(){var e=$(this).find("section.js_prerequistes_side");h($(this).find("select[name=semid]"),$(this).find("section.js_select_pre select"),e);var i=$(this).find("section.js_equivalences_side");g($(this).find("section.js_select_eq select"),i),$(this).find("section.js_prerequistes_side").children("article").each(function(i){_(i,e)}),$(this).find("section.js_equivalences_side").children("article").each(function(e){y(e,i)}),b($(this).find("form")),$(this).find(".js_tab-pre-eq"),f($(this).find(".js_tab-pre-eq"))}).addClass("active");var s=$("section.semester").find("article.data_course.course_clicked");s&&($(s).find(".btn_edit_course").html("Editar"),$(s).removeClass("course_clicked"),$(s).siblings(".edit_course").addClass("inactive"),setTimeout(function(){$(s).siblings(".edit_course").removeClass("active inactive")},300)),$(a).addClass("course_clicked"),$(i).html("Cancelar")}})}function g(e,i){var a,r,s=0,t=$(i).children("p");e.siblings("a").on("click",function(){a=e.val();var c=!1;if($(i).children("article").each(function(){a==$(this).find("input").val()&&(c=!0)}),a&&!c){r=e.children("option:selected").html();var n=1;if($(i).children("article").each(function(){n++,s++}),2>=n){var l='<article id="equivalence'+s+'"><p>'+r+'</p><input type="hidden" name="eq_'+n+'" value="'+a+'"><a href="##"><span class="glyphicon glyphicon-remove"></span></a></article>';$(t).addClass("inactive"),$(i).append(l),y(s,i),s++}}})}function y(e,i){var a=$(i).find("#equivalence"+e);$(a).addClass("active"),$(a).find("a").on("click",function(){$(a).addClass("inactive"),setTimeout(function(){var e=!1;$(a).removeClass("active inactive").remove(),$(i).children("article").each(function(i){var a=i+1;$(this).find("input").attr("name","eq_"+a),e=!0}),e||$(i).children("p").removeClass("inactive")},300)})}function b(e){$(e).on("submit",function(e){e.preventDefault();var i=$(this).parent().siblings(".data_course"),a=$(this).siblings(".msg_side").children(".msg.success"),s=$(this).siblings(".msg_side").children(".msg.warning"),t=$(this).find("input[type=submit]");$(t).attr("disabled","true").val("Guardando..."),$.ajax({type:"post",url:"/curricula/curricula/saveeditcourse",data:$(this).serialize(),dataType:"json",success:function(e){if(1===e.success)if("RC"==r)if($(i).children("span:nth-of-type(3)").html(e.name),$(i).children("span:nth-of-type(4)").html(e.credits),$(i).children("span:nth-of-type(5)").html(e.type),$(i).children("span:nth-of-type(6)").html(e.req),$(i).children("span:nth-of-type(7)").removeClass("stateA stateI"),$(i).children("span:nth-of-type(7)").addClass("state"+e.state),$(i).children("span:nth-of-type(7)").html(e.state),$("#id_select_pre").find("option[code-course="+e.idjs+"]").html(e.idjs+" | "+e.name),e.change_semester){$(t).val("Moviendo al Semestre "+e.semid+"..."),D(a,s,1500),$("#id_select_pre").find("option[code-course="+e.idjs+"]").attr("semester",e.semid),p($("#id_select_pre"),$("#form_add_new_course").find("select[name=semid]").val());var c=$(i).siblings(".edit_course");setTimeout(function(){$(i).removeClass("course_clicked"),$(i).find("a.btn_edit_course").html("Editar"),$(c).addClass("inactive"),setTimeout(function(){$(c).removeClass("active inactive");var a=$(i).parent().html();$(i).parent().remove(),$("#id_section_semester"+e.semid).append('<div id="id_course_'+e.idjs+'" class="all_course_data" idactivatejs="'+e.idjs+'">'+a+"</div>"),w($("#id_section_semester"+e.semester_current)),w($("#id_section_semester"+e.semid)),C(e.idjs)},300)},1800)}else D(a,s,5e3),$(t).removeAttr("disabled").val("Guardar");else"DR"==r&&(D(a,s,5e3),$(t).removeAttr("disabled").val("Guardar"));else 0===e.success&&(j(s,e.errors),D(s,a,7e3),$(t).removeAttr("disabled").val("Guardar"))},error:function(){$(t).removeAttr("disabled").val("Guardar")}})});var i=$(e).find("a[type=delete]"),a=$(e).parent(),s=$(e).siblings(".msg_delete").children("a:nth-of-type(1)"),t=$(e).siblings(".msg_delete").children("a:nth-of-type(2)");$(i).on("click",function(){$(a).addClass("delete")}),$(t).on("click",function(){$(a).removeClass("delete")}),$(s).on("click",function(){var e=$(this).siblings(".msg_side").children(".msg.warning"),i=$(this).siblings(".msg_side").children(".msg.success"),r=$(this).attr("code");$.ajax({url:"/curricula/curricula/deletecourse",data:{id:r},dataType:"json",success:function(r){1===r.success?(D(i,e,1500),setTimeout(function(){$(a).addClass("inactive"),setTimeout(function(){$(a).removeClass("active inactive"),$(a).parent().remove(),w($(a).parent().parent())},300)},1500)):0===r.success&&D(e,i,7e3)},error:function(){D(e,i,7e3)}})})}function w(e){var i=!1;$(e).children("div.all_course_data").each(function(e){$(this).children("article.data_course").children("span:nth-of-type(1)").html(e+1),i=!0}),i?($(e).children("article.title").removeClass("inactive"),$(e).children("p").addClass("inactive")):($(e).children("article.title").addClass("inactive"),$(e).children("p").removeClass("inactive"))}function D(e,i,a){$(i).hasClass("show")?($(i).addClass("hide"),setTimeout(function(){$(i).removeClass("show hide"),$(e).addClass("show")},300)):$(e).addClass("show"),clearTimeout(A),A=setTimeout(function(){$(e).addClass("hide"),setTimeout(function(){$(e).removeClass("show hide")},300)},a)}function j(e,i){$(e).html(""),i.forEach(function(i){$(e).append('<p><span class="glyphicon glyphicon-exclamation-sign"></span> '+i+"</p>")})}function T(e){var i=!0;$(e).children(".curriculum").each(function(e,a){$(a).children("span:nth-child(1)").html(e+1),i=!1}),$(e).hasClass("div_temporary")&&$(e).parent().hasClass("main_hide")&&($(e).parent().slideDown("fast"),$(e).parent().siblings(".for_message").slideUp("fast")),i?($(e).children(".empty_message").slideDown("fast"),$(e).hasClass("div_draft")&&setTimeout(function(){$(e).parent(".main").slideUp("fast"),$(e).children(".empty_message").slideUp("fast")},7e3)):($(e).siblings(".empty").slideUp("fast"),$(e).children(".empty_message").slideUp("fast"))}var q,A,k="",S="",N="";return{chargeSchools:e,chargeCurriculums:i}}var i="",a=e(),r=$("#rol").val();"RC"==r||"RF"==r||"CU"==r?($("#selectFaculty").on("change",function(){i=$(this).val(),a.chargeSchools(i)}),$("#selectSchool").on("change",function(){i=$(this).val(),a.chargeCurriculums(i)})):"DR"==r&&(i=$("#school").val(),a.chargeCurriculums(i))});