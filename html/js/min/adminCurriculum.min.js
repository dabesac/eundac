$(function(){function e(){function e(e){$("#dataCurriculums").html(""),e?$("#selectSchool").html('<option value="">Cargando...</option>').load("/default/global/listschools/id/"+e):$("#selectSchool").html('<option value="">Escuela</option><option value="">Primero seleccione alguna facultad ¬¬</option>')}function i(e){e?$("#dataCurriculums").html('<br><br><center><img src="/img/spinner.gif" alt="Loading" /></center>').load("/curricula/curricula/listcurriculums/id/"+e,function(){j=$("#selectSpeciality").val(),r(j),t()}):$("#dataCurriculums").html("")}function r(e){$(".curriculums").each(function(){currentLiText=$(this).text(),showCurrentLi=-1!==currentLiText.indexOf(e),$(this).toggle(showCurrentLi),showCurrentLi&&(existData=0)}),"RC"==a&&$("html body").animate({scrollTop:$("#selectFaculty").offset().top})}function t(){$("#selectSpeciality").on("change",function(){j=$(this).val(),r(j),"RC"==a&&$("#dataFormNewCur").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/newcurricula/id/"+j,function(){l()})}),"RC"==a&&$("#dataFormNewCur").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/newcurricula/id/"+j,function(){l()});var e;$(".curriculum").each(function(i,a){e=$(a).attr("idactivatejs"),s(e)})}function s(e){var i=$("#curriculum"+e),a=$(i).find(".modify").children(".btnDetailCur"),r=$(i).find(".modify").children(".btn_derive"),t=$(i).find(".modify").children(".btn_delete"),s=$(i).attr("state");$(i).hasClass("showCurriculum")&&$(i).removeClass("showCurriculum"),$(a).on("click",function(){c(),A=$(this).attr("ide"),k=$(this).attr("idjs"),$("#dataDetailCur").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/admincurriculum/state/"+s+"/id/"+A,function(){d(A,k)})});var l,u;$(r).on("click",function(){u=$(this);var e=$(u).siblings(".derive_from_draft");l=$(u).attr("goto"),A=$(u).attr("ide"),k=$(u).attr("idjs"),$(u).toggleClass("active_a");var i="";$(".derive_from_draft").each(function(e,a){i=$(a).attr("fromto"),l!=i&&$(a).hasClass("active_derive")&&($(a).siblings(".btn_derive").removeClass("active_a"),$(a).addClass("hide_derive"),setTimeout(function(){$(a).removeClass("active_derive hide_derive")},300))}),$(".delete_curriculum").each(function(e,i){$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),$(".btn_delete").removeClass("active_delete"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm"),$(i).parent().slideUp(150)},300))}),$(e).hasClass("active_derive")?($(e).addClass("hide_derive"),setTimeout(function(){$(e).removeClass("active_derive hide_derive")},300)):$(e).addClass("active_derive")}),$(t).on("click",function(){u=$(this),l=$(u).attr("goto"),A=$(u).attr("ide"),$(".btn_derive").removeClass("active_a active_active active_temporary active_close"),$(".derive_from_draft").each(function(e,i){$(i).hasClass("active_derive")&&($(i).addClass("hide_derive"),setTimeout(function(){$(i).removeClass("active_derive hide_derive")},300))})}),$("#curriculum"+e+" .derive_from_draft a, #curriculum"+e+" .btn_delete").on("click",function(){var e=$(this),i=$(e).parent(".derive_from_draft");$(i).addClass("hide_derive"),setTimeout(function(){$(i).removeClass("active_derive hide_derive")},300);var a=$(e).attr("type"),r="",t="";$(".confirm_side").each(function(e,i){t=$(i).parent().attr("fromto"),r=$(i).attr("type"),l!=t?$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm"),$(i).parent().slideUp(150)},300)):a!=r&&$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm")},300))}),$(".btn_delete").removeClass("active_delete"),$(".btn_derive").removeClass("active_a active_active active_temporary active_close");var s=a+"_curriculum",c="active_"+a,n=$("#curriculum_confirm"+l).find("."+s);$("#curriculum_confirm"+l).slideDown(150),$(n).addClass("active_confirm"),$(u).removeClass("active_a active_active active_temporary active_close").addClass(c)}),$("#curriculum_confirm"+e+" .confirm_side a:nth-child(3)").on("click",function(){c()}),$("#curriculum_confirm"+e+" .confirm_side a:nth-child(2)").on("click",function(){var e=$(this).attr("whycallme");$(this).html('<img src="/img/spinner.gif" alt="Loading..." />'),n(e,A,l)})}function c(){$(".btn_derive").removeClass("active_a active_active active_temporary active_close"),$(".btn_delete").removeClass("active_delete"),$(".confirms_side .confirm_side").each(function(e,i){$(i).hasClass("active_confirm")&&($(i).addClass("hide_confirm"),setTimeout(function(){$(i).removeClass("active_confirm hide_confirm"),$(i).parent().slideUp(150)},300))}),$(".derive_from_draft").each(function(e,i){$(i).hasClass("active_derive")&&($(i).siblings(".btn_derive").removeClass("active_a"),$(i).addClass("hide_derive"),setTimeout(function(){$(i).removeClass("active_derive hide_derive")},300))})}function n(e,i,a){$.ajax({url:"/curricula/curricula/icallyou",data:{id:i,why:e},dataType:"json",success:function(r){if(1===r.success){c();var t=new Object;if(t.name=$("#curriculum"+a+" span:nth-child(2)").html(),t.year=$("#curriculum"+a+" span:nth-child(3)").html(),"A"==e){var n=$("#curriculums"+j).find(".div_active"),l=$("#curriculum"+a).parent(),d=$(n).children(".curriculum");if($(d).attr("state")){var u=new Object;u.name=$(d).children("span:nth-child(2)").html(),u.year=$(d).children("span:nth-child(3)").html(),u.idJs=$(d).attr("idactivatejs"),u.idGet=$(d).attr("idget")}$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove();var e='<div id="curriculum'+a+'" class="curriculum showCurriculum" idactivatejs="'+a+'" idget="'+i+'" state="A"><span><span class="glyphicon glyphicon-ok"></span></span><span>'+t.name+"</span><span>"+t.year+'</span><div class="modify active_modify"><a href="##" ide="'+i+'" idjs="'+a+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a></div></div>';if($(n).html(e),s(a),$(n).siblings(".empty").slideUp("fast"),$(d).attr("state")){e='<div id="curriculum'+u.idJs+'" class="curriculum showCurriculum" idactivatejs="'+u.idJs+'" state="T"><span><span class="glyphicon glyphicon-ok"></span></span><span>'+u.name+"</span><span>"+u.year+'</span><div class="modify temporary_modify"><a href="##" ide="'+u.idGet+'" idjs="'+u.idJs+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="##" class="btn_derive" ide="'+u.idGet+'" goto="'+u.idJs+'">Derivar</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a><div class="derive_from_draft" fromto="'+u.idJs+'"><a href="##" type="active">Activar Curricula</a><a href="##" type="close">Cerrar Curricula</a></div></div></div><div id="curriculum_confirm'+u.idJs+'" fromto="'+u.idJs+'" class="confirms_side"><div class="confirm_side delete_curriculum" type="delete"><p>Confírme si desea eliminar esta currícula...</p><a href="##" whycallme="D">Si, quiero eliminarla</a><a href="##">Cancelar</a></div><div class="confirm_side active_curriculum" type="active"><p>Confírme si desea activar esta currícula, si hay otra activa ésta la remplazara...</p><a href="##" whycallme="A">Si, quiero activarla</a><a href="##">Cancelar</a></div><div class="confirm_side temporary_curriculum" type="temporary"><p>Confírme si desea mover esta currícula a temporales...</p><a href="##" whycallme="T">Si, quiero moverla a temporales</a><a href="##">Cancelar</a></div><div class="confirm_side close_curriculum" type="close"><p>Confírme si desea cerrar esta currícula...</p><a href="##" whycallme="C">Si, quiero cerrarla</a><a href="##">Cancelar</a></div></div>';var r=$("#curriculums"+j).find(".div_temporary");$(r).prepend(e),s(u.idJs),w(r)}w(l)},300)}else if("T"==e){var n=$("#curriculums"+j).find(".div_temporary"),l=$("#curriculum"+a).parent();$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove();var e='<div id="curriculum'+a+'" class="curriculum showCurriculum" idactivatejs="'+a+'" state="T"><span><span class="glyphicon glyphicon-ok"></span></span><span>'+t.name+"</span><span>"+t.year+'</span><div class="modify temporary_modify"><a href="##" ide="'+i+'" idjs="'+a+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="##" class="btn_derive" ide="'+i+'" goto="'+a+'">Derivar</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a><div class="derive_from_draft" fromto="'+a+'"><a href="##" type="active">Activar Curricula</a><a href="##" type="close">Cerrar Curricula</a></div></div></div><div id="curriculum_confirm'+a+'" fromto="'+a+'" class="confirms_side"><div class="confirm_side delete_curriculum" type="delete"><p>Confírme si desea eliminar esta currícula...</p><a href="##" whycallme="D">Si, quiero eliminarla</a><a href="##">Cancelar</a></div><div class="confirm_side active_curriculum" type="active"><p>Confírme si desea activar esta currícula, si hay otra activa ésta la remplazara...</p><a href="##" whycallme="A">Si, quiero activarla</a><a href="##">Cancelar</a></div><div class="confirm_side temporary_curriculum" type="temporary"><p>Confírme si desea mover esta currícula a temporales...</p><a href="##" whycallme="T">Si, quiero moverla a temporales</a><a href="##">Cancelar</a></div><div class="confirm_side close_curriculum" type="close"><p>Confírme si desea cerrar esta currícula...</p><a href="##" whycallme="C">Si, quiero cerrarla</a><a href="##">Cancelar</a></div></div>';$(n).prepend(e),s(a),w(l),w(n)},300)}else if("C"==e){var n=$("#curriculums"+j).find(".div_close"),l=$("#curriculum"+a).parent();$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove();var e='<div id="curriculum'+a+'" class="curriculum" idactivatejs="'+a+'" state="C"><span>0</span><span>'+t.name+"</span><span>"+t.year+'</span><div class="modify close_modify"><a href="##" ide="'+i+'" idjs="'+a+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Detalles</a><a href="/curricula/curricula/print/id/'+i+'">Imprimir</a></div></div>';$(n).prepend(e),s(a),w(l),w(n)},300)}else if("D"==e){var l=$("#curriculum"+a).parent();$("#curriculum"+a).addClass("removeCurriculum"),setTimeout(function(){$("#curriculum"+a+", #curriculum_confirm"+a).remove(),w(l)},300)}}},error:function(){}})}function l(){$("#formCurriculum").on("submit",function(e){e.preventDefault();var i=$(this),a=$(this).find("input[type=submit]"),r=$(this).siblings(".msg_side").children(".msg.warning"),t=$(this).siblings(".msg_side").children(".msg.success");a.attr("disabled","disabled").val("Guardando..."),$.ajax({type:"post",url:"/curricula/curricula/savenew",data:$(this).serialize(),dataType:"json",success:function(e){if(1===e.success){var c='<div class="curriculum" id="curriculum'+e.dataNew.idJs+'" state="B"><span>RC</span><span><span class="nameChangeEdit">'+e.dataNew.name+"</span> <small>"+e.dataNew.curid+"</small></span><span>Año "+e.dataNew.year+'</span><div class="modify draftModify"><a href="##" ide="'+e.dataNew.id+'" idjs="'+e.dataNew.idJs+'" class="btnDetailCur" data-toggle="modal" data-target="#modalDetailCur" title="Mire los detalles de esta currícula...">Administrar Curricula</a><a href="##" class="btn_derive" ide="'+e.dataNew.id+'" goto="'+e.dataNew.idJs+'">Derivar</a><a href="##" class="btn_delete" ide="'+e.dataNew.id+'" type="delete" goto="'+e.dataNew.idJs+'">Eliminar</a><div class="derive_from_draft" fromto="'+e.dataNew.idJs+'"><a href="##" type="active">Activar Curricula</a><a href="##" type="temporary">Mover a Temporales</a><a href="##" type="close">Cerrar Curricula</a></div></div></div><div id="curriculum_confirm'+e.dataNew.idJs+'" fromto="'+e.dataNew.idJs+'" class="confirms_side"><div class="confirm_side delete_curriculum" type="delete"><p>Confírme si desea eliminar esta currícula...</p><a href="##" whycallme="D">Si, quiero eliminarla</a><a href="##">Cancelar</a></div><div class="confirm_side active_curriculum" type="active"><p>Confírme si desea activar esta currícula, si hay otra activa ésta la remplazara...</p><a href="##" whycallme="A">Si, quiero activarla</a><a href="##">Cancelar</a></div><div class="confirm_side temporary_curriculum" type="temporary"><p>Confírme si desea mover esta currícula a temporales...</p><a href="##" whycallme="T">Si, quiero moverla a temporales</a><a href="##">Cancelar</a></div><div class="confirm_side close_curriculum" type="close"><p>Confírme si desea cerrar esta currícula...</p><a href="##" whycallme="C">Si, quiero cerrarla</a><a href="##">Cancelar</a></div></div>',n=$("#curriculums"+j).find(".div_draft");$(n).prepend(c),s(e.dataNew.idJs),w(n),$(i).find(".form-control").val(""),y(t,r,2e3),clearTimeout(D),D=setTimeout(function(){$("#modalNewCur").modal("hide"),a.removeAttr("disabled").val("Guardar")},2e3),$("#curriculums"+j).find(".main_draft").slideDown("fast")}else 0===e.success&&(b(r,e.errors),y(r,t,7e3))},error:function(){y(r,t,7e3),$(r).html("<p>Ups! Parece que hubo un error, fijese que no haya otra currícula en el mismo año y periódo igual al que esta creando...</p>")}}),a.removeAttr("disabled").val("Guardar")})}function d(e){$("#detailCur_btnEditCur").on("click",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeOut("fast",function(){$("#idDivEditCurriculum, #idHeaderEdit").fadeIn("fast")})}),$("#detailCur_btnAdminCourses").on("click",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeOut("fast",function(){$("#idDivAdminCourses, #idHeaderAdmin").fadeIn("fast")})}),$("#detailCur_edit_btnBackToDetail").on("click",function(){$("#idDivEditCurriculum, #idHeaderEdit").fadeOut("fast",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeIn("fast")})}),$("#detailCur_courses_btnBackToDetail").on("click",function(){$("#idDivAdminCourses, #idHeaderAdmin").fadeOut("fast",function(){$("#idDivDetailCurricula, #idHeaderDetail").fadeIn("fast")})}),$("#idDivDetailCurricula").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/detailcurriculum/id/"+e,function(){u()}),("RC"==a||"DR"==a)&&$("#idDivEditCurriculum").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/editcurriculum/id/"+e,function(){o(e,k)}),$("#idDivAdminCourses").html('<br><br><br><center><img src="/img/spinner.gif" alt="Loading..." /></center>').load("/curricula/curricula/admincourses/id/"+e,function(){m(e,k)})}function u(){}function o(e){$("#formEditCurriculum").on("submit",function(i){i.preventDefault();var a=$(this).find("input[type=submit]"),r=($(this).find("input[name=name]").val(),$(this).siblings(".msg_side").children(".msg.warning")),t=$(this).siblings(".msg_side").children(".msg.success");$(a).attr("disabled","disabled").val("Guardando..."),$.ajax({type:"post",url:"/curricula/curricula/saveedit",data:$(this).serialize(),dataType:"json",success:function(i){1===i.success?(y(t,r,2e3),$("#idDivDetailCurricula").html('<img src="/img/spinner.gif" alt="Loading..." />').load("/curricula/curricula/detailcurriculum/id/"+e,function(){u()}),$("section.new_course").load("/curricula/curricula/newcourse/id/"+e,function(){v()})):0===i.success?(b(r,i.errors),y(r,t,7e3)):2===i.success,a.removeAttr("disabled").val("Guardar")},error:function(){a.removeAttr("disabled").val("Guardar")}})})}function m(){$("section.new_course").load("/curricula/curricula/newcourse/id/"+A,function(){v()}),$("#btn_add_course").on("click",function(){$("#id_error_course_side").slideUp("fast"),$("#id_add_new_course").hasClass("active")?($(this).removeClass("btn_cancel").html("Agregar Curso"),$(this).parent().parent().removeClass("header_active"),$("#id_add_new_course").addClass("inactive"),setTimeout(function(){$("#id_add_new_course").removeClass("active inactive")},300)):($(this).addClass("btn_cancel").html("Cancelar"),$(this).parent().parent().addClass("header_active"),$("#id_add_new_course").addClass("active"))});var e;$(".all_course_data").each(function(i,a){e=$(a).attr("idactivatejs"),_(e)})}function v(){$("#form_add_new_course").on("submit",function(e){e.preventDefault();var i=$(this),a=$(this).parent().parent().siblings("header").find("a#btn_add_course"),r=($(this).find("input[type=submit]"),$(this).siblings(".msg_side").children(".msg.warning")),t=$(this).siblings(".msg_side").children(".msg.success");$.ajax({type:"post",url:"/curricula/curricula/savecourse",data:$(this).serialize(),dataType:"json",success:function(e){if(1===e.success){var s='<div id="id_course_'+e.idjs+'" class="all_course_data" idactivatejs="'+e.idjs+'"><article class="data_course"><span>#</span>	<span>'+e.idjs+"</span><span>"+e.name+"</span><span>"+e.credits+"</span><span>"+e.type+"</span><span>"+e.req+'</span><span class="stateA">A</span><a href="##" class="btn_edit_course" code="'+e.idget+'">Editar</a></article><article class="edit_course"></article></div>';$("#id_section_semester"+e.semester).append(s),_(e.idjs),g($("#id_section_semester"+e.semester)),y(t,r,1700),setTimeout(function(){$(i).find("input[type=text]").val(""),$(i).find("select[name=semid]").val(1),$("#id_select_pre").append('<option semester="'+e.semester+'" code-course="'+e.idjs+'" value="'+e.id_en+'">'+e.idjs+" | "+e.name+"</option>");var r=$("#id_select_pre").parent().siblings(".prerequisites");h($("#id_select_pre"),1),$(r).children("article").each(function(){var e=$(this);1<$(e).attr("semester")&&($(e).addClass("inactive"),setTimeout(function(){var i=!1;$(e).removeClass("active inactive").remove(),$(r).children("article").each(function(e){var a=e+1;$(this).find("input").attr("name","pre_"+a),i=!0}),i||$(r).children("p").removeClass("inactive")},300))}),$(a).removeClass("btn_cancel").html("Agregar Curso"),$(a).parent().parent().removeClass("header_active"),$("#id_add_new_course").addClass("inactive"),setTimeout(function(){$("#id_add_new_course").removeClass("active inactive")},300)},2e3)}else 0===e.success&&(b(r,e.errors),y(r,t,7e3))},error:function(){}})});{var e=$("#id_select_pre").parent().siblings(".prerequisites");$(e).children("p")}f($("#semid"),$("#id_select_pre"),e)}function f(e,i,a){var r=$(e).val();h(i,r),$(e).on("change",function(){r=parseInt($(this).val()),h(i,r),$(a).children("article").each(function(){var e=$(this);r<$(e).attr("semester")&&($(e).addClass("inactive"),setTimeout(function(){var i=!1;$(e).removeClass("active inactive").remove(),$(a).children("article").each(function(e){var a=e+1;$(this).find("input").attr("name","pre_"+a),i=!0}),i||$(a).children("p").removeClass("inactive")},300))})});var t=$(a).children("p"),s=0;$(i).siblings("a").on("click",function(){var e=$(i).val(),c=!1;if($(a).children("article").each(function(){e==$(this).find("input").val()&&(c=!0)}),e&&!c){var n=$(i).children("option:selected").html(),l=1;if($(a).children("article").each(function(){l++,s++}),3>=l){var d='<article semester="'+r+'" id="prerequisite'+s+'"><p>'+n+'</p><input type="hidden" name="pre_'+l+'" value="'+e+'"><a href="##"><span class="glyphicon glyphicon-remove"></span></a></article>';$(t).addClass("inactive"),$(a).append(d),p(s,a),s++}}})}function h(e,i){var a,r=!1,t=!1;$(e).children("option").each(function(){a=parseInt($(this).attr("semester")),i>a?(r||a!=i-1||($(e).children("option[semester=0]").html("Agregue un prerequisito..."),$(e).val($(this).val()),r=!0),0!=a&&(t=!0),$(this).removeAttr("hidden")):$(this).attr("hidden","true")}),t&&!r?$(e).children("option[semester=0]").html("Agregue un prerequisito..."):t||($(e).children("option[semester=0]").html("No hay prerequisitos..."),$(e).val("")),1==i&&$(e).children("option[semester=0]").html("No hay prerequisitos para el primer semestre...")}function p(e,i){var a=$(i).find("#prerequisite"+e);$(a).addClass("active"),$(a).find("a").on("click",function(){$(a).addClass("inactive"),setTimeout(function(){var e=!1;$(a).removeClass("active inactive").remove(),$(i).children("article").each(function(i){var a=i+1;$(this).find("input").attr("name","pre_"+a),e=!0}),e||$(i).children("p").removeClass("inactive")},300)})}function _(e){var i=$("#id_course_"+e).find(".btn_edit_course"),a=$("#id_course_"+e).find("article.data_course"),r=$("#id_course_"+e).find("article.edit_course");$(i).on("click",function(){var e=$(this).attr("code");if($(a).hasClass("course_clicked"))$(a).removeClass("course_clicked"),$(i).html("Editar"),$(r).addClass("inactive"),setTimeout(function(){$(r).removeClass("active inactive")},300);else{$(r).html('<img src="/img/spinner.gif" alt="Loading..." />').load("/curricula/curricula/editcourse/id/"+e,function(){var e=$(this).find("section.prerequisites");f($(this).find("select[name=semid]"),$(this).find("section.select_pre select"),e),$(this).find("section.prerequisites").children("article").each(function(i){p(i,e)}),C($(this).find("form"))}).addClass("active");var t=$("section.semester").find("article.data_course.course_clicked");t&&($(t).find(".btn_edit_course").html("Editar"),$(t).removeClass("course_clicked"),$(t).siblings(".edit_course").addClass("inactive"),setTimeout(function(){$(t).siblings(".edit_course").removeClass("active inactive")},300)),$(a).addClass("course_clicked"),$(i).html("Cancelar")}})}function C(e){$(e).on("submit",function(e){e.preventDefault();var i=$(this).parent().siblings(".data_course"),r=$(this).siblings(".msg_side").children(".msg.success"),t=$(this).siblings(".msg_side").children(".msg.warning"),s=$(this).find("input[type=submit]");$(s).attr("disabled","true").val("Guardando..."),$.ajax({type:"post",url:"/curricula/curricula/saveeditcourse",data:$(this).serialize(),dataType:"json",success:function(e){if(1===e.success)if("RC"==a)if($(i).children("span:nth-of-type(3)").html(e.name),$(i).children("span:nth-of-type(4)").html(e.credits),$(i).children("span:nth-of-type(5)").html(e.type),$(i).children("span:nth-of-type(6)").html(e.req),$(i).children("span:nth-of-type(7)").removeClass("stateA stateI"),$(i).children("span:nth-of-type(7)").addClass("state"+e.state),$(i).children("span:nth-of-type(7)").html(e.state),$("#id_select_pre").find("option[code-course="+e.idjs+"]").html(e.idjs+" | "+e.name),e.change_semester){$(s).val("Moviendo al Semestre "+e.semid+"..."),y(r,t,1500),$("#id_select_pre").find("option[code-course="+e.idjs+"]").attr("semester",e.semid),h($("#id_select_pre"),$("#form_add_new_course").find("select[name=semid]").val());var c=$(i).siblings(".edit_course");setTimeout(function(){$(i).removeClass("course_clicked"),$(i).find("a.btn_edit_course").html("Editar"),$(c).addClass("inactive"),setTimeout(function(){$(c).removeClass("active inactive");var a=$(i).parent().html();$(i).parent().remove(),$("#id_section_semester"+e.semid).append('<div id="id_course_'+e.idjs+'" class="all_course_data" idactivatejs="'+e.idjs+'">'+a+"</div>"),g($("#id_section_semester"+e.semester_current)),g($("#id_section_semester"+e.semid)),_(e.idjs)},300)},1800)}else y(r,t,5e3),$(s).removeAttr("disabled").val("Guardar");else"DR"==a&&(y(r,t,5e3),$(s).removeAttr("disabled").val("Guardar"));else 0===e.success&&(b(t,e.errors),y(t,r,7e3),$(s).removeAttr("disabled").val("Guardar"))},error:function(){$(s).removeAttr("disabled").val("Guardar")}})});var i=$(e).find("a[type=delete]"),r=$(e).parent(),t=$(e).siblings(".msg_delete").children("a:nth-of-type(1)"),s=$(e).siblings(".msg_delete").children("a:nth-of-type(2)");$(i).on("click",function(){$(r).addClass("delete")}),$(s).on("click",function(){$(r).removeClass("delete")}),$(t).on("click",function(){var e=$(this).siblings(".msg_side").children(".msg.warning"),i=$(this).siblings(".msg_side").children(".msg.success"),a=$(this).attr("code");$.ajax({url:"/curricula/curricula/deletecourse",data:{id:a},dataType:"json",success:function(a){1===a.success?(y(i,e,1500),setTimeout(function(){$(r).addClass("inactive"),setTimeout(function(){$(r).removeClass("active inactive"),$(r).parent().remove(),g($(r).parent().parent())},300)},1500)):0===a.success&&y(e,i,7e3)},error:function(){y(e,i,7e3)}})})}function g(e){var i=!1;$(e).children("div.all_course_data").each(function(e){$(this).children("article.data_course").children("span:nth-of-type(1)").html(e+1),i=!0}),i?($(e).children("article.title").removeClass("inactive"),$(e).children("p").addClass("inactive")):($(e).children("article.title").addClass("inactive"),$(e).children("p").removeClass("inactive"))}function y(e,i,a){$(i).hasClass("show")?($(i).addClass("hide"),setTimeout(function(){$(i).removeClass("show hide"),$(e).addClass("show")},300)):$(e).addClass("show"),clearTimeout(T),T=setTimeout(function(){$(e).addClass("hide"),setTimeout(function(){$(e).removeClass("show hide")},300)},a)}function b(e,i){$(e).html(""),i.forEach(function(i){$(e).append('<p><span class="glyphicon glyphicon-exclamation-sign"></span> '+i+"</p>")})}function w(e){var i=!0;$(e).children(".curriculum").each(function(e,a){$(a).children("span:nth-child(1)").html(e+1),i=!1}),$(e).hasClass("div_temporary")&&$(e).parent().hasClass("main_hide")&&($(e).parent().slideDown("fast"),$(e).parent().siblings(".for_message").slideUp("fast")),i?($(e).children(".empty_message").slideDown("fast"),$(e).hasClass("div_draft")&&setTimeout(function(){$(e).parent(".main").slideUp("fast"),$(e).children(".empty_message").slideUp("fast")},7e3)):($(e).siblings(".empty").slideUp("fast"),$(e).children(".empty_message").slideUp("fast"))}var D,T,j="",A="",k="";return{chargeSchools:e,chargeCurriculums:i}}var i="",e=e(),a=$("#rol").val();"RC"==a||"RF"==a||"CU"==a?($("#selectFaculty").on("change",function(){i=$(this).val(),e.chargeSchools(i)}),$("#selectSchool").on("change",function(){i=$(this).val(),e.chargeCurriculums(i)})):"DR"==a&&(i=$("#school").val(),e.chargeCurriculums(i))});